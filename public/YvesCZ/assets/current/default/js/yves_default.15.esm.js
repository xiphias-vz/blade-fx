(window["webpackJsonp_yves_default"] = window["webpackJsonp_yves_default"] || []).push([[15],{

/***/ "./src/Pyz/Yves/CustomerConfirmationPage/Theme/default/components/molecules/customer-confirmation-form/customer-confirmation-form.ts":
/*!*******************************************************************************************************************************************!*\
  !*** ./src/Pyz/Yves/CustomerConfirmationPage/Theme/default/components/molecules/customer-confirmation-form/customer-confirmation-form.ts ***!
  \*******************************************************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return CustomerConfirmationForm; });
/* harmony import */ var ShopUi_models_component__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ShopUi/models/component */ "./vendor/spryker-shop/shop-ui/src/SprykerShop/Yves/ShopUi/Theme/default/models/component.ts");
function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }


var HIDDEN_CLASS_NAME = 'is-hidden';
class CustomerConfirmationForm extends ShopUi_models_component__WEBPACK_IMPORTED_MODULE_0__["default"] {
  constructor() {
    super(...arguments);

    _defineProperty(this, "newPasswordInput", void 0);

    _defineProperty(this, "phoneInput", void 0);

    _defineProperty(this, "passwordHintHolder", void 0);

    _defineProperty(this, "phoneHintHolder", void 0);

    _defineProperty(this, "phoneErrorMessage", void 0);

    _defineProperty(this, "submitButton", void 0);

    _defineProperty(this, "customerConfirmationForm", void 0);

    _defineProperty(this, "thirdPartyRegistration", void 0);

    _defineProperty(this, "phonePrefix", void 0);

    _defineProperty(this, "mobilePrefix", void 0);

    _defineProperty(this, "mobileInput", void 0);
  }

  readyCallback() {}

  init() {
    this.newPasswordInput = this.querySelector(this.newPasswordSelector);
    this.phoneInput = this.querySelector(this.phoneSelector);
    this.passwordHintHolder = this.getElementsByClassName(this.jsName + "__password-criteria")[0];
    this.phoneHintHolder = this.getElementsByClassName(this.jsName + "__phone-criteria")[0];
    this.phoneErrorMessage = this.getElementsByClassName(this.jsName + "__phone-error")[0];
    this.submitButton = this.getElementsByClassName(this.jsName + "__submit-button")[0];
    this.thirdPartyRegistration = document.getElementsByName("registerForm[third_party_registration]")[1];
    this.customerConfirmationForm = this.getElementsByClassName(this.jsName + "__form")[0].children[0];
    this.phonePrefix = document.getElementById("registerForm_phone_prefix");
    this.mobilePrefix = document.getElementById("registerForm_mobile_phone_prefix");
    this.mobileInput = document.getElementById("registerForm_phone");
    this.mapEvents();
  }

  mapEvents() {
    if (this.newPasswordInput) {
      this.newPasswordInput.addEventListener('focus', () => this.showElement(this.passwordHintHolder));
      this.newPasswordInput.addEventListener('blur', () => this.hideElement(this.passwordHintHolder));
    }

    if (this.phoneInput) {
      this.phoneInput.addEventListener('focus', () => this.showElement(this.phoneHintHolder));
      this.phoneInput.addEventListener('blur', event => this.phoneBlur(event));
      this.phoneInput.addEventListener('input', () => this.hideElement(this.phoneErrorMessage));
    }

    if (this.mobileInput) {
      this.mobileInput.addEventListener('blur', event => this.phoneBlur(event));
    }

    if (this.submitButton) {
      this.submitButton.addEventListener('click', event => this.submitCustomerConfirmationForm(event));
    }
  }

  showElement(element) {
    element.classList.remove(HIDDEN_CLASS_NAME);
  }

  hideElement(element) {
    element.classList.add(HIDDEN_CLASS_NAME);
  }

  isPhoneNumberValid() {
    var pattern = /^[+ 0-9]+$/;
    var phoneNumber = this.phoneInput.value;
    return pattern.test(phoneNumber);
  }

  submitCustomerConfirmationForm(event) {
    var isPhoneNumberValid = this.isPhoneNumberValid();

    if (isPhoneNumberValid && this.thirdPartyRegistration.checked) {
      this.customerConfirmationForm.submit();
      return;
    }

    event.preventDefault();
    this.showElement(this.phoneErrorMessage);
  }

  get formName() {
    return this.getAttribute('form-name');
  }

  get newPasswordSelector() {
    return this.getAttribute('new-password-selector');
  }

  get phoneSelector() {
    return this.getAttribute('phone-selector');
  }

  phoneBlur(event) {
    this.hideElement(this.phoneHintHolder);
    var target = event.target;
    var prefix = target.id.includes("mobile") ? this.phonePrefix : this.mobilePrefix;

    if (prefix !== undefined && prefix !== null) {
      if (prefix.value.length > 0 && target.value.length > 0 && !target.value.startsWith(prefix.value)) target.value = prefix.value + target.value;
    }
  }

}

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvUHl6L1l2ZXMvQ3VzdG9tZXJDb25maXJtYXRpb25QYWdlL1RoZW1lL2RlZmF1bHQvY29tcG9uZW50cy9tb2xlY3VsZXMvY3VzdG9tZXItY29uZmlybWF0aW9uLWZvcm0vY3VzdG9tZXItY29uZmlybWF0aW9uLWZvcm0udHMiXSwibmFtZXMiOlsiSElEREVOX0NMQVNTX05BTUUiLCJDdXN0b21lckNvbmZpcm1hdGlvbkZvcm0iLCJDb21wb25lbnQiLCJyZWFkeUNhbGxiYWNrIiwiaW5pdCIsIm5ld1Bhc3N3b3JkSW5wdXQiLCJxdWVyeVNlbGVjdG9yIiwibmV3UGFzc3dvcmRTZWxlY3RvciIsInBob25lSW5wdXQiLCJwaG9uZVNlbGVjdG9yIiwicGFzc3dvcmRIaW50SG9sZGVyIiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsImpzTmFtZSIsInBob25lSGludEhvbGRlciIsInBob25lRXJyb3JNZXNzYWdlIiwic3VibWl0QnV0dG9uIiwidGhpcmRQYXJ0eVJlZ2lzdHJhdGlvbiIsImRvY3VtZW50IiwiZ2V0RWxlbWVudHNCeU5hbWUiLCJjdXN0b21lckNvbmZpcm1hdGlvbkZvcm0iLCJjaGlsZHJlbiIsInBob25lUHJlZml4IiwiZ2V0RWxlbWVudEJ5SWQiLCJtb2JpbGVQcmVmaXgiLCJtb2JpbGVJbnB1dCIsIm1hcEV2ZW50cyIsImFkZEV2ZW50TGlzdGVuZXIiLCJzaG93RWxlbWVudCIsImhpZGVFbGVtZW50IiwiZXZlbnQiLCJwaG9uZUJsdXIiLCJzdWJtaXRDdXN0b21lckNvbmZpcm1hdGlvbkZvcm0iLCJlbGVtZW50IiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwiYWRkIiwiaXNQaG9uZU51bWJlclZhbGlkIiwicGF0dGVybiIsInBob25lTnVtYmVyIiwidmFsdWUiLCJ0ZXN0IiwiY2hlY2tlZCIsInN1Ym1pdCIsInByZXZlbnREZWZhdWx0IiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiLCJ0YXJnZXQiLCJwcmVmaXgiLCJp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cEI7QUFDQSxRQUFJQyxNQUF5QixHQUFHRCxNQUFNLENBQUNFLEVBQVAsQ0FBVUMsUUFBVixDQUFtQixRQUFuQixJQUErQixLQUFLNUIsV0FBcEMsR0FBa0QsS0FBS0UsWUFBdkY7O0FBQ0EsUUFBSXdCLE1BQU0sS0FBS0csU0FBWCxJQUF3QkgsTUFBTSxLQUFLLElBQXZDLEVBQTZDO0FBQ3pDLFVBQUdBLE1BQU0sQ0FBQ1IsS0FBUCxDQUFhWSxNQUFiLEdBQXNCLENBQXRCLElBQTJCTCxNQUFNLENBQUNQLEtBQVAsQ0FBYVksTUFBYixHQUFzQixDQUFqRCxJQUFzRCxDQUFDTCxNQUFNLENBQUNQLEtBQVAsQ0FBYWEsVUFBYixDQUF3QkwsTUFBTSxDQUFDUixLQUEvQixDQUExRCxFQUNJTyxNQUFNLENBQUNQLEtBQVAsR0FBZVEsTUFBTSxDQUFDUixLQUFQLEdBQWVPLE1BQU0sQ0FBQ1AsS0FBckM7QUFDUDtBQUNKOztBQWxHMkQsQyIsImZpbGUiOiIuL2pzL3l2ZXNfZGVmYXVsdC4xNS5lc20uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQ29tcG9uZW50IGZyb20gJ1Nob3BVaS9tb2RlbHMvY29tcG9uZW50JztcblxuY29uc3QgSElEREVOX0NMQVNTX05BTUUgPSAnaXMtaGlkZGVuJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ3VzdG9tZXJDb25maXJtYXRpb25Gb3JtIGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgICBwcm90ZWN0ZWQgbmV3UGFzc3dvcmRJbnB1dDogSFRNTElucHV0RWxlbWVudDtcbiAgICBwcm90ZWN0ZWQgcGhvbmVJbnB1dDogSFRNTElucHV0RWxlbWVudDtcbiAgICBwcm90ZWN0ZWQgcGFzc3dvcmRIaW50SG9sZGVyOiBIVE1MRWxlbWVudDtcbiAgICBwcm90ZWN0ZWQgcGhvbmVIaW50SG9sZGVyOiBIVE1MRWxlbWVudDtcbiAgICBwcm90ZWN0ZWQgcGhvbmVFcnJvck1lc3NhZ2U6IEhUTUxFbGVtZW50O1xuICAgIHByb3RlY3RlZCBzdWJtaXRCdXR0b246IEhUTUxCdXR0b25FbGVtZW50O1xuICAgIHByb3RlY3RlZCBjdXN0b21lckNvbmZpcm1hdGlvbkZvcm06IEhUTUxGb3JtRWxlbWVudDtcbiAgICBwcm90ZWN0ZWQgdGhpcmRQYXJ0eVJlZ2lzdHJhdGlvbjogSFRNTElucHV0RWxlbWVudDtcbiAgICBwcm90ZWN0ZWQgcGhvbmVQcmVmaXg6IEhUTUxTZWxlY3RFbGVtZW50O1xuICAgIHByb3RlY3RlZCBtb2JpbGVQcmVmaXg6IEhUTUxTZWxlY3RFbGVtZW50O1xuICAgIHByb3RlY3RlZCBtb2JpbGVJbnB1dDogSFRNTElucHV0RWxlbWVudDtcblxuICAgIHByb3RlY3RlZCByZWFkeUNhbGxiYWNrKCk6IHZvaWQge31cblxuICAgIHByb3RlY3RlZCBpbml0KCk6IHZvaWQge1xuICAgICAgICB0aGlzLm5ld1Bhc3N3b3JkSW5wdXQgPSA8SFRNTElucHV0RWxlbWVudD50aGlzLnF1ZXJ5U2VsZWN0b3IodGhpcy5uZXdQYXNzd29yZFNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5waG9uZUlucHV0ID0gPEhUTUxJbnB1dEVsZW1lbnQ+dGhpcy5xdWVyeVNlbGVjdG9yKHRoaXMucGhvbmVTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMucGFzc3dvcmRIaW50SG9sZGVyID0gPEhUTUxFbGVtZW50PnRoaXMuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShgJHt0aGlzLmpzTmFtZX1fX3Bhc3N3b3JkLWNyaXRlcmlhYClbMF07XG4gICAgICAgIHRoaXMucGhvbmVIaW50SG9sZGVyID0gPEhUTUxFbGVtZW50PnRoaXMuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShgJHt0aGlzLmpzTmFtZX1fX3Bob25lLWNyaXRlcmlhYClbMF07XG4gICAgICAgIHRoaXMucGhvbmVFcnJvck1lc3NhZ2UgPSA8SFRNTEVsZW1lbnQ+dGhpcy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGAke3RoaXMuanNOYW1lfV9fcGhvbmUtZXJyb3JgKVswXTtcbiAgICAgICAgdGhpcy5zdWJtaXRCdXR0b24gPSA8SFRNTEJ1dHRvbkVsZW1lbnQ+dGhpcy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGAke3RoaXMuanNOYW1lfV9fc3VibWl0LWJ1dHRvbmApWzBdO1xuICAgICAgICB0aGlzLnRoaXJkUGFydHlSZWdpc3RyYXRpb24gPSA8SFRNTElucHV0RWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50c0J5TmFtZShcInJlZ2lzdGVyRm9ybVt0aGlyZF9wYXJ0eV9yZWdpc3RyYXRpb25dXCIpWzFdO1xuICAgICAgICB0aGlzLmN1c3RvbWVyQ29uZmlybWF0aW9uRm9ybSA9IDxIVE1MRm9ybUVsZW1lbnQ+dGhpcy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGAke3RoaXMuanNOYW1lfV9fZm9ybWApWzBdLmNoaWxkcmVuWzBdO1xuICAgICAgICB0aGlzLnBob25lUHJlZml4ID0gPEhUTUxTZWxlY3RFbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmVnaXN0ZXJGb3JtX3Bob25lX3ByZWZpeFwiKTtcbiAgICAgICAgdGhpcy5tb2JpbGVQcmVmaXggPSA8SFRNTFNlbGVjdEVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZWdpc3RlckZvcm1fbW9iaWxlX3Bob25lX3ByZWZpeFwiKTtcbiAgICAgICAgdGhpcy5tb2JpbGVJbnB1dCA9IDxIVE1MSW5wdXRFbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmVnaXN0ZXJGb3JtX3Bob25lXCIpO1xuICAgICAgICB0aGlzLm1hcEV2ZW50cygpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBtYXBFdmVudHMoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLm5ld1Bhc3N3b3JkSW5wdXQpIHtcbiAgICAgICAgICAgIHRoaXMubmV3UGFzc3dvcmRJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsICgpID0+IHRoaXMuc2hvd0VsZW1lbnQodGhpcy5wYXNzd29yZEhpbnRIb2xkZXIpKTtcbiAgICAgICAgICAgIHRoaXMubmV3UGFzc3dvcmRJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgKCkgPT4gdGhpcy5oaWRlRWxlbWVudCh0aGlzLnBhc3N3b3JkSGludEhvbGRlcikpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMucGhvbmVJbnB1dCkge1xuICAgICAgICAgICAgdGhpcy5waG9uZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgKCkgPT4gdGhpcy5zaG93RWxlbWVudCh0aGlzLnBob25lSGludEhvbGRlcikpO1xuICAgICAgICAgICAgdGhpcy5waG9uZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCAoZXZlbnQ6IEV2ZW50KSA9PiB0aGlzLnBob25lQmx1cihldmVudCkpO1xuICAgICAgICAgICAgdGhpcy5waG9uZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4gdGhpcy5oaWRlRWxlbWVudCh0aGlzLnBob25lRXJyb3JNZXNzYWdlKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubW9iaWxlSW5wdXQpIHtcbiAgICAgICAgICAgIHRoaXMubW9iaWxlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIChldmVudDogRXZlbnQpID0+IHRoaXMucGhvbmVCbHVyKGV2ZW50KSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5zdWJtaXRCdXR0b24pIHtcbiAgICAgICAgICAgIHRoaXMuc3VibWl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50OiBFdmVudCkgPT4gdGhpcy5zdWJtaXRDdXN0b21lckNvbmZpcm1hdGlvbkZvcm0oZXZlbnQpKTtcbiAgICAgICAgfVxuXG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIHNob3dFbGVtZW50KGVsZW1lbnQ6IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShISURERU5fQ0xBU1NfTkFNRSk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGhpZGVFbGVtZW50KGVsZW1lbnQ6IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZChISURERU5fQ0xBU1NfTkFNRSk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGlzUGhvbmVOdW1iZXJWYWxpZCgpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgcGF0dGVybiA9IC9eWysgMC05XSskLztcbiAgICAgICAgY29uc3QgcGhvbmVOdW1iZXIgPSB0aGlzLnBob25lSW5wdXQudmFsdWU7XG5cbiAgICAgICAgcmV0dXJuIHBhdHRlcm4udGVzdChwaG9uZU51bWJlcik7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIHN1Ym1pdEN1c3RvbWVyQ29uZmlybWF0aW9uRm9ybShldmVudDogRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgaXNQaG9uZU51bWJlclZhbGlkID0gdGhpcy5pc1Bob25lTnVtYmVyVmFsaWQoKTtcbiAgICAgICAgaWYgKGlzUGhvbmVOdW1iZXJWYWxpZCAmJiB0aGlzLnRoaXJkUGFydHlSZWdpc3RyYXRpb24uY2hlY2tlZCkge1xuICAgICAgICAgICAgdGhpcy5jdXN0b21lckNvbmZpcm1hdGlvbkZvcm0uc3VibWl0KCk7XG5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHRoaXMuc2hvd0VsZW1lbnQodGhpcy5waG9uZUVycm9yTWVzc2FnZSk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGdldCBmb3JtTmFtZSgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRBdHRyaWJ1dGUoJ2Zvcm0tbmFtZScpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBnZXQgbmV3UGFzc3dvcmRTZWxlY3RvcigpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRBdHRyaWJ1dGUoJ25ldy1wYXNzd29yZC1zZWxlY3RvcicpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBnZXQgcGhvbmVTZWxlY3RvcigpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRBdHRyaWJ1dGUoJ3Bob25lLXNlbGVjdG9yJyk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIHBob25lQmx1cihldmVudDogRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5oaWRlRWxlbWVudCh0aGlzLnBob25lSGludEhvbGRlcik7XG4gICAgICAgIGxldCB0YXJnZXQgPSAoZXZlbnQudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnQpO1xuICAgICAgICBsZXQgcHJlZml4OiBIVE1MU2VsZWN0RWxlbWVudCA9IHRhcmdldC5pZC5pbmNsdWRlcyhcIm1vYmlsZVwiKSA/IHRoaXMucGhvbmVQcmVmaXggOiB0aGlzLm1vYmlsZVByZWZpeDtcbiAgICAgICAgaWYgKHByZWZpeCAhPT0gdW5kZWZpbmVkICYmIHByZWZpeCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgaWYocHJlZml4LnZhbHVlLmxlbmd0aCA+IDAgJiYgdGFyZ2V0LnZhbHVlLmxlbmd0aCA+IDAgJiYgIXRhcmdldC52YWx1ZS5zdGFydHNXaXRoKHByZWZpeC52YWx1ZSkpXG4gICAgICAgICAgICAgICAgdGFyZ2V0LnZhbHVlID0gcHJlZml4LnZhbHVlICsgdGFyZ2V0LnZhbHVlO1xuICAgICAgICB9XG4gICAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==