{% extends template('page-layout-main') %}

{% define data = {
    title: required,
    message: required,
    collectNumber: '',
    requestedDeliveryDate: '',
    deliveryMethodKey: '',
    orderReference:'',
    items: '',
    totals: '',
    payments: '',
} %}

{%- block class -%}{{ parent() }} page-layout-main--success-page{%- endblock -%}

{% block breadcrumbs %}{% endblock %}

{% block title %}{% endblock %}

{% block content %}
    <div class="page-layout-checkout success-page text-center">
        <div class="success-page__container container">
            <h1 class="title">{{ data.title }}</h1>
            <p class="success-page__text">{{ data.message }}</p>
            <div class="success-information-holder" style="text-align: left;margin:0px auto;width:80%">
                <strong>Wie geht es weiter?</strong>
                <p>Ihre Bestellbestätigung <strong> {{ data.orderReference }}</strong> ist bereits auf dem Weg in Ihr Email-Postfach - prüfen Sie also unbedingt auch Ihren Spam Ordner.<br>
                    Ihren <strong>Abholschein</strong> erhalten Sie direkt am <strong>Abholtag per Mail</strong>, sobald wir Ihre Bestellung fertig gepackt haben.
                    Darin finden Sie außerdem den <strong> detaillierten Lieferstatus </strong> aller bestellten Artikel<br/><br/><br/>
                    Weitere Fragen zu Ihrer Bestellung oder dem Abholschein?<br/>
                    Erfahren Sie Mehr unter: <a style="color:orange" href="https://globus.zendesk.com/hc/de">https://globus.zendesk.com/hc/de</a>
                </p>
            </div>
            {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                <a style="background: orange" class="button" href="{{ url('customer/overview') }}">{{ 'checkout.step.success.link' | trans }}</a>
            {% endif %}
        </div>
    </div>
    <script>
        window.dataLayer = window.dataLayer || [];
        window.dataLayer.push({
            'event':'eec.purchase',
            'ecommerce':
                {
                    'currencyCode': 'EUR',
                    'purchase':
                        {
                            'actionField': {
                                'id': '{{ data.orderReference }}',
                                'subtotal': '{{ data.totals.subtotal is defined ? data.totals.subtotal / 100 : null }}',
                                'expenseTotal': '{{ data.totals.expenseTotal is defined ? data.totals.expenseTotal / 100 : null }}',
                                'priceToPay': '{{ data.totals.priceToPay is defined ? data.totals.priceToPay / 100 : null  }}',
                                'grandTotal': '{{ data.totals.grandTotal is defined ? data.totals.grandTotal / 100 : null  }}',
                                'discountTotal' : '{{ data.totals.discountTotal is defined ? data.totals.discountTotal / 100 : null }}',
                                'netTotal' : '{{ data.totals.netTotal is defined ? data.totals.netTotal / 100 : null }}',
                                'refundTotal' : '{{ data.totals.refundTotal is defined ? data.totals.refundTotal / 100 : null }}',
                            },
                        }
                }
        });
    </script>
{% endblock %}
