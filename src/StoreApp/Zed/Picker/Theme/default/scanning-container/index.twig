{% extends template('page-layout-main') %}

{% define data = {
    merchant: merchant,
    orderForScanningContainer: orderForScanningContainer,
    nextOrderPosition: nextOrderPosition,
    orderPosition: orderPosition,
    orderItemPosition: orderItemPosition,
    requestFromPickingArticles: requestFromPickingArticles,
    redirectToPickingArticles: redirectToPickingArticles,
    itemSku: itemSku,
    isContainerUsed: isContainerUsed | default(null),
    isUsedContainerMessage: isUsedContainerMessage,
    isScanFromPickingProcess: isScanFromPickingProcess | default,
    isMultiPickingProcess: isMultiPickingProcess | default('0'),
    pickZoneName: pickZoneName | default,
    isDepositAllowed: isDepositAllowed,
    addContainerToSubstitutedItem: addContainerToSubstitutedItem,
} %}

{% set backButtonUrl = '/picker/multi-picking?unlock=true' %}
{% if data.addContainerToSubstitutedItem %}
    {% set backButtonUrl = '/picker/multi-picking/multi-order-picking?sku=' ~ data.itemSku ~ '&position=' ~ data.orderItemPosition %}
{% endif %}

{% block header %}
    {% include organism('header') with {
        data: {
            headerLocationTitle: data.pickZoneName,
            withoutLogo: true,
            pickingZone: true,
            isScanFromPickingProcess: isScanFromPickingProcess,
            isMultiPickingProcess: isMultiPickingProcess,
            buttonUrl: backButtonUrl
        }
    } only %}
{% endblock %}


{% block content %}
        {% embed molecule('popup-ui-error') with {
            data: {
                isErrorTrue: data.isContainerUsed,
                isUsedContainerMessage: data.isUsedContainerMessage,
                buttons: {
                    submit: {
                        isButton: true,
                        additionalClass: 'js-pick-products__submit',
                    },
                },
            },
        } only %}
    {% endembed %}

    {% include molecule('container-color') with {
        data: {
            colorCode: data.orderForScanningContainer.pickingColor.backColor,
            colorNumber: data.orderForScanningContainer.pickingColor.idColor,
            textColor: data.orderForScanningContainer.pickingColor.foreColor,
            isSubstitutionAllowed: data.orderForScanningContainer.isSubstitutionAllowed | default,
            isDepositAllowed: data.isDepositAllowed
        }
    } only %}

    {% include molecule('container-scan-order') with {
        data: {
            nextOrderPosition: data.nextOrderPosition,
            orderPosition: orderPosition,
            orderItemPosition: orderItemPosition,
            idOrderReference: data.orderForScanningContainer.orderReference,
            itemSku: itemSku,
            usedContainersWithShelf: data.orderForScanningContainer.pickingContainers,
            pickingColor: data.orderForScanningContainer.pickingColor,
            requestFromPickingArticles: requestFromPickingArticles,
            redirectToPickingArticles: redirectToPickingArticles,
            isContainerUsed: data.isContainerUsed,
            isDepositAllowed: data.isDepositAllowed,
            addContainerToSubstitutedItem: data.addContainerToSubstitutedItem,
        }
    } only %}
{% endblock content %}
