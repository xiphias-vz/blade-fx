{% extends template('page-layout-main') %}

{% set currentIndex = 0 %}
{% define data = {
    idOrder: idOrder,
    pickZone: pickZone,
    sku: sku,
    orders: orders,
    backButtonUrl: backButtonUrl,
    overviewButtonUrl: overviewButtonUrl,
    position: position,
    fromModal: fromModal,
    allPaused: allPaused,
    urlContainerSelect: urlContainerSelect,
    orderPosition: orderPosition,
    orderItemPosition: orderItemPosition
} %}
{% block header %}
   {% include organism('header') with {
        data: {
            posListe: true,
            headerLocationTitle: pickZone,
            withoutLogo: true,
            pickingZone: true,
            buttonUrl: data.backButtonUrl,
        }
    } only %}
{% endblock %}
{% block content %}
    <div id="divElementPosListe">
    {% for key,item in data.orders %}
        {% if (data.sku == item.ean) %}
            {% set currentIndex = key %}
        {% endif %}
            {% embed molecule('pos-liste-item') with {
                data: {
                    idOrderItem: item.idOrderItem,
                    quantity: item.quantity,
                    quantityPicked: item.quantityPicked,
                    color: item.pickingColor,
                    name: item.name,
                    ean: item.ean,
                    isPaused: item.isPausedStatus,
                    isCanceled: item.isCancelledStatus,
                    isAllPicked: item.isFullPicked,
                    isPartiallyPicked: item.isPartiallyPicked,
                    pictureUrl: item.pictureUrl,
                    sequence: item.sequence,
                    shelf: item.shelf,
                    shelfFloor: item.shelfFloor,
                    shelfField: item.shelfField,
                    aisle: item.aisle,
                    orderNumber: item.idOrder,
                    orders: item.orders,
                    pickingItemPosition: item.pickingItemPosition,
                    fromModal: data.fromModal,
                    itemsQuantity: item.itemsQuantity,
                    allPaused: data.allPaused,
                    itemSkuFrom: data.sku,
                    shortEan: item.shortEan,
                    totalWeight: item.totalWeight,
                    priceUnit: item.priceUnit
                },
            } only %}
            {% endembed %}
    {% endfor %}
    </div>
    <script type="text/javascript">
        const currentIndex = {{ currentIndex }};
        const countItems = {{ data.orders | length }};
        const tblSku = document.getElementById("tbLSku_{{ data.sku }}");
        if(countItems > 5) {
            if (currentIndex === countItems) {
                document.getElementById('divElementPosListe').style.marginBottom = "200px";
            } else if (currentIndex === countItems - 1) {
                document.getElementById('divElementPosListe').style.marginBottom = "150px";
            }
        }
        setTimeout(function (){
            tblSku.scrollIntoView({ behavior: 'auto', block: 'center', inline: 'center' });
        },500);
    </script>
    {% include molecule('multi-picking-additional-order-buttons') with {
        data: {
            idSalesOrder: data.idOrder,
            urlContainerSelect: data.urlContainerSelect,
            itemSku: data.sku,
            posListeForm: true,
            urlMultiPickingOverview: data.overviewButtonUrl,
            addFromModal: data.fromModal,
            position: data.position,
            orderPosition: data.orderPosition,
            orderItemPosition: data.orderItemPosition,
        }
    } only %}
{% endblock %}
{% block footer %}

{% endblock %}
